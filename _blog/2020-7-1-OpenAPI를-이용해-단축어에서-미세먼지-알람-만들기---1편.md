---
title: OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1
subtitle: 미세먼지 일일이 검색하지 말고 단축어로 바로 보기.
layout: post
type: shortcut
---
# 원하는 데이터의 API 찾기
[공공데이터 포털](https://www.data.go.kr)
이곳에는 정부의 다양한 데이터들이 있고, 각 데이터들을 요청할 수 있는 API가 제공 되어있다.

오늘 예제로 사용해볼 데이터는 미세먼지 데이터!  

일단, api를 사용하기 위해서는 공공데이터 포털에 가입이 되어있어야한다. 가입은 간단하게 할 수 있으므로, 가입을 한 뒤 미세먼지를 검색.  

![/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_1.png](/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_1.png)

검색해보면, 오픈 API 항목에서 한국환경공단_대기오염 정보를 찾을 수 있다.  

클릭해서 들어가보면,
![/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_2.png](/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_2.png)

이렇게 API 정보가 뜨고, PC화면으로 본다면, 옆에 활용신청이라는 버튼이 뜬다.  

![/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_3.png](/assets/images/OpenAPI를 이용해 단축어에서 미세먼지 알람 만들기 - 1편/img_3.png)

활용신청 버튼을 누르면, API사용 목적과 기타 정보를 적으라고 하는데, 간단히 적어주고 제출.  
제출을 완료 했다면, 마이페이지에 들어가서 승인이 되었는지 확인한다. 보통 바로 승인을 해주는 것 같다. 아무튼, 승인된 api를 누르고, 서비스 정보에서 일반 인증키 ( ServiceKey )를 복사해서 저장한다. 이 코드가 api를 요청할때 필요한 서비스키!.  

다만, 이 상태로 단축어에서 이용하면, UTF-8로 인코딩이 되어있어 잘못된 서비스키라는 에러메세지를 보게 된다. 따라서 이 서비스키를 디코딩 해주어야한다.  

[URL Decode and Encode - Online](https://www.urldecoder.org)
이 사이트의 첫 번째 블럭에다가 서비스키를 넣고 아래 Decode 버튼을 누르면, 디코딩 된 서비스키가 나온다. 이것을 복사해서 어딘가에다가 저장해둔다.  

# API 요청 명령어
이 API에는 여러가지 데이터를 조회할 수 있지만, 이번에 볼 데이터는, 측정소별 실시간 측정정보이다.  

이 정보를 조회하기 위해서는, 몇 가지 parameter가 필요한다. 이 내용은 참고문서에 적혀있고, 예시는 이렇게 되어있다.  

```
http://openapi.airkorea.or.kr/openapi/services/rest/ArpltnInforInqireSvc/getMsrstnAcctoRltmMesureDnsty?
serviceKey=서비스키&
numOfRows=10&
pageNo=1&
stationName=종로구&
dataTerm=DAILY&
ver=1.3&
```

일단 이런 형태로 되어있다. ( 한 눈에 보이기 하기 위해, 엔터로 구분해 놨다. 원래는 한 줄로 되어있다.)  

첫번째 줄은 endpoint이다. 데이터를 요청할때, 어디에 요청할지에 대한 정보가 적혀있다.  

그 아랫 줄 부터는 차례로 api를 요청할 때 필요한 parameter들이다.  

`ServiceKey` → 서비스 키이다. 이 것이 있어야 api를 요청할 수 있다.  

`numOfRows` → 요청하는 데이터의 row 수이다.  

`pageNo` → 요청하는 데이터의 페이지 수  

`stationName` → 관측소 명 ([https://www.airkorea.or.kr/web/stationInfo?pMENU_NO=93](https://www.airkorea.or.kr/web/stationInfo?pMENU_NO=93) 여기서 관측소 명을 찾아볼 수 있다.)  

`dataTerm` → DAILY, MONTH, 3MONTH 순으로 있다.  

`ver` → 버전 넘버 (자세한 설명은 도큐멘트 안에 있다.)  


그리고! ios 단축어에서 사용하기 위해서는 데이터 형태가 json 형태가 되어야 한다. 기본으로는 xml 데이터를 받기 때문에, 파라미터에 json 으로 달라고 하는 인자를 넣어야하는데, 이 걸 마지막에 넣어주면 된다.  

`&_returnType=json`


필요한 인자들을 각 파라미터에 넣어주면 준비 끝.  

2편에서는 이 데이터를 어떻게 단축어에서 요청하고 처리하는지를 다뤄볼 것이다.  
